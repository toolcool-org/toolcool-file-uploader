/* 
Tool Cool File Uploader
Version: 0.0.1
Documentation: https://github.com/toolcool-org/toolcool-file-uploader
License:    
Author: Tool Cool, toolcool.org@gmail.com>                          
*/
(()=>{var f=(r,i,t)=>new Promise((e,n)=>{var d=l=>{try{a(t.next(l))}catch(c){n(c)}},o=l=>{try{a(t.throw(l))}catch(c){n(c)}},a=l=>l.done?e(l.value):Promise.resolve(l.value).then(d,o);a((t=t.apply(r,i)).next())});var b=r=>{let i=[];return{init:()=>{if(!!r.plugins)for(let o of r.plugins){let a=o(r);i.push(a),a.init&&typeof a.init=="function"&&a.init()}},upload:o=>{for(let a of i)a.upload&&typeof a.upload=="function"&&a.upload(o)},destroy:()=>{for(let o of i)o.destroy&&typeof o.destroy=="function"&&o.destroy()},getPlugins:()=>i}},p=b;var v=r=>r.slice((Math.max(0,r.lastIndexOf("."))||1/0)+1).trim().toLowerCase();var I=r=>!isNaN(parseFloat(r))&&isFinite(r);var h=(r,i)=>{for(let t of i)if(t.extensions.includes("*")||t.extensions.includes(r))return!0;return!1},D=(r,i)=>{for(let t of i)if(t.mimeTypes.includes("*")||t.mimeTypes.includes(r))return!0;return!1},T=(r,i,t)=>f(void 0,null,function*(){let e=v(i.name);if(!h(e,t))return{isValid:!1,message:`The '.${e}' file extension is not supported.`};if(!D(i.type,t))return{isValid:!1,message:`The '${i.type}' file MIME type is not supported.`};if(I(r.maxSizeInBytes)&&i.size>r.maxSizeInBytes)return{isValid:!1,message:`The maximum file size must not exceed ${r.maxSizeInBytes} bytes.`};for(let n of t){if(!n.validate||typeof n.validate!="function")continue;let d=yield n.validate(r,i);if(!d.isValid)return d}return{isValid:!0,message:""}}),y=(r,i,t)=>f(void 0,null,function*(){if(!r.validationEnabled)return{isValid:!0,message:""};for(let e of i){let n=yield T(r,e,t);if(!n.isValid)return n}return{isValid:!0,message:""}});var x="is-dragover",F=(r,i)=>{let t=null,e=r.querySelector('[data-tc="upload-panel"]'),n=e==null?void 0:e.querySelector('input[type="file"]'),d=s=>{s.preventDefault(),s.stopPropagation()},o=s=>{s.preventDefault(),s.stopPropagation(),e==null||e.classList.remove(x)},a=s=>{s.preventDefault(),s.stopPropagation(),e==null||e.classList.add(x)},l=s=>f(void 0,null,function*(){o(s),!(!s||!s.dataTransfer||!s.dataTransfer.files||s.dataTransfer.files.length<0)&&(yield c(Array.from(s.dataTransfer.files)))}),c=s=>f(void 0,null,function*(){var m;let g=yield y(i,s,(m=t==null?void 0:t.getPlugins())!=null?m:[]);if(!g.isValid){alert(g.message);return}t==null||t.upload({files:s,$uploader:r,$uploadPanel:e,$fileInput:n})}),u=s=>f(void 0,null,function*(){let g=s.target;!g.files||g.files.length<=0||(yield c(Array.from(g.files)))});return t=p(i),t.init(),n==null||n.addEventListener("change",u),e==null||e.addEventListener("drag",d),e==null||e.addEventListener("dragstart",d),e==null||e.addEventListener("dragend",o),e==null||e.addEventListener("dragleave",o),e==null||e.addEventListener("dragover",a),e==null||e.addEventListener("dragenter",a),e==null||e.addEventListener("drop",l),{destroy:()=>{n==null||n.removeEventListener("change",u),e==null||e.removeEventListener("drag",d),e==null||e.removeEventListener("dragstart",d),e==null||e.removeEventListener("dragend",o),e==null||e.removeEventListener("dragleave",o),e==null||e.removeEventListener("dragover",a),e==null||e.removeEventListener("dragenter",a),e==null||e.removeEventListener("drop",l),t==null||t.destroy()}}},E=F;var L={path:"",plugins:[],validationEnabled:!0};var S=r=>{let i,t,e=d=>{let o=Object.assign(L,d);if(t=document.querySelector(o.path),!t){console.error("File uploader error: the path property is not defined.");return}i=E(t,o)},n=()=>{i==null||i.destroy(),i=void 0,t=void 0};return e(r),{destroy:n}},Q=S;window.tcFileUploader=S;})();
//# sourceMappingURL=toolcool-file-uploader.min.js.map
