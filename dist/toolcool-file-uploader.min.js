/* 
Tool Cool File Uploader
Version: 0.0.1
Documentation: https://github.com/toolcool-org/toolcool-file-uploader
License:    
Author: Tool Cool, toolcool.org@gmail.com>                          
*/
(()=>{var c=(i,n,t)=>new Promise((e,r)=>{var o=s=>{try{l(t.next(s))}catch(g){r(g)}},a=s=>{try{l(t.throw(s))}catch(g){r(g)}},l=s=>s.done?e(s.value):Promise.resolve(s.value).then(o,a);l((t=t.apply(i,n)).next())});var b=i=>{let n=[];return{init:()=>{if(!!i.plugins)for(let a of i.plugins){let l=a(i);n.push(l),l.init&&typeof l.init=="function"&&l.init()}},upload:a=>{for(let l of n)l.upload&&typeof l.upload=="function"&&l.upload(a)},destroy:()=>{for(let a of n)a.destroy&&typeof a.destroy=="function"&&a.destroy()},getPlugins:()=>n}},I=b;var u=i=>i.slice((Math.max(0,i.lastIndexOf("."))||1/0)+1).trim().toLowerCase();var D=(i,n)=>{for(let t of n)if(t.extensions.includes(i))return!0;return!1},S=(i,n)=>{for(let t of n)if(t.mimeTypes.includes(i))return!0;return!1},E=(i,n,t)=>{if(!i.validationEnabled)return{isValid:!0,message:""};let e=u(n.name);return D(e,t)?S(n.type,t)?{isValid:!0,message:""}:{isValid:!1,message:`The '${n.type}' file MIME type is not supported.`}:{isValid:!1,message:`The '.${e}' file extension is not supported.`}};var L="is-dragover",w=(i,n)=>{let t=null,e=i.querySelector('[data-tc="upload-panel"]'),r=e==null?void 0:e.querySelector('input[type="file"]'),o=d=>{d.preventDefault(),d.stopPropagation()},a=d=>{d.preventDefault(),d.stopPropagation(),e==null||e.classList.remove(L)},l=d=>{d.preventDefault(),d.stopPropagation(),e==null||e.classList.add(L)},s=d=>c(void 0,null,function*(){if(a(d),!d||!d.dataTransfer||!d.dataTransfer.files||d.dataTransfer.files.length<0)return;let f=d.dataTransfer.files[0];yield g(f)}),g=d=>c(void 0,null,function*(){var p;let f=E(n,d,(p=t==null?void 0:t.getPlugins())!=null?p:[]);if(!f.isValid){alert(f.message);return}t==null||t.upload({file:d,$uploader:i,$uploadPanel:e})}),m=d=>c(void 0,null,function*(){let f=d.target;if(!f.files||f.files.length<=0)return;let p=f.files[0];yield g(p)});return t=I(n),t.init(),r==null||r.addEventListener("change",m),e==null||e.addEventListener("drag",o),e==null||e.addEventListener("dragstart",o),e==null||e.addEventListener("dragend",a),e==null||e.addEventListener("dragleave",a),e==null||e.addEventListener("dragover",l),e==null||e.addEventListener("dragenter",l),e==null||e.addEventListener("drop",s),{destroy:()=>{r==null||r.removeEventListener("change",m),e==null||e.removeEventListener("drag",o),e==null||e.removeEventListener("dragstart",o),e==null||e.removeEventListener("dragend",a),e==null||e.removeEventListener("dragleave",a),e==null||e.removeEventListener("dragover",l),e==null||e.removeEventListener("dragenter",l),e==null||e.removeEventListener("drop",s),t==null||t.destroy()}}},y=w;var C=i=>new Promise((n,t)=>{let e=new Image;e.crossOrigin="Anonymous",e.onerror=o=>t(o),e.onload=o=>{let{width:a,height:l}=o.target;n({$image:e,width:a,height:l})};let r=new FileReader;r.onerror=o=>t(o),r.onload=()=>{e.src=r.result},r.readAsDataURL(i)}),M=i=>{let n,t,e,r,o,a=()=>{var s;!n||((s=n.$uploadPanel)==null||s.classList.remove("hidden"),e==null||e.classList.add("hidden"),t==null||t.$image.remove(),t=void 0)},l=()=>{var s,g;!n||i.uploadCallback&&typeof i.uploadCallback=="function"&&i.uploadCallback({file:n.file,ext:u((g=(s=n.file)==null?void 0:s.name)!=null?g:"")})};return{id:"ImagePreviewPlugin",title:"Image Preview Plugin",extensions:["jpg","jpeg","png","apng","gif","avif","svg","webp"],mimeTypes:["image/jpeg","image/png","image/apng","image/avif","image/svg+xml","image/webp"],upload:s=>c(void 0,null,function*(){var m,v,d;if(n=s,e=n.$uploader.querySelector('[data-tc="preview-panel"]'),!e)return;(m=n.$uploadPanel)==null||m.classList.add("hidden"),e==null||e.classList.remove("hidden"),t=yield C(n.file);let g=e.querySelector('[data-tc="preview"]');g==null||g.append(t.$image),i.previewCallback&&typeof i.previewCallback=="function"&&i.previewCallback({file:s.file,ext:u((d=(v=s.file)==null?void 0:v.name)!=null?d:"")}),r=e.querySelector('[data-tc="cancel-preview-btn"]'),r==null||r.addEventListener("click",a),o=e.querySelector('[data-tc="upload-btn"]'),o==null||o.addEventListener("click",l)}),destroy:()=>{var s;try{(s=t==null?void 0:t.$image)==null||s.remove()}catch(g){}r==null||r.removeEventListener("click",a),o==null||o.removeEventListener("click",l),n=void 0,t=void 0,e=void 0,r=void 0,o=void 0}}},x=M;var h={path:"",plugins:[x],validationEnabled:!0};var T=i=>{let n,t,e=o=>{let a=Object.assign(h,o);if(t=document.querySelector(a.path),!t){console.error("File uploader error: the path property is not defined.");return}n=y(t,a)},r=()=>{n==null||n.destroy(),n=void 0,t=void 0};return e(i),{destroy:r}},$=T;window.tcFileUploader=T;})();
//# sourceMappingURL=toolcool-file-uploader.min.js.map
