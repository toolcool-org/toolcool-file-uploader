/* 
Tool Cool File Uploader
Version: 0.0.1
Documentation: https://github.com/toolcool-org/toolcool-file-uploader
License:    
Author: Tool Cool, toolcool.org@gmail.com>                          
*/
(()=>{var f=(s,n,t)=>new Promise((e,o)=>{var r=g=>{try{a(t.next(g))}catch(c){o(c)}},i=g=>{try{a(t.throw(g))}catch(c){o(c)}},a=g=>g.done?e(g.value):Promise.resolve(g.value).then(r,i);a((t=t.apply(s,n)).next())});var h=s=>{let n=[];return{init:()=>{if(!!s.plugins)for(let r of s.plugins){let i=r();n.push(i),i.init&&typeof i.init=="function"&&i.init()}},upload:r=>{for(let i of n)i.upload&&typeof i.upload=="function"&&i.upload(r)},destroy:()=>{for(let r of n)r.destroy&&typeof r.destroy=="function"&&r.destroy()}}},u=h;var p="is-dragover",D=(s,n)=>{let t=null,e=s.querySelector('[data-tc="upload-panel"]'),o=e==null?void 0:e.querySelector('input[type="file"]'),r=d=>{d.preventDefault(),d.stopPropagation()},i=d=>{d.preventDefault(),d.stopPropagation(),e==null||e.classList.remove(p)},a=d=>{d.preventDefault(),d.stopPropagation(),e==null||e.classList.add(p)},g=d=>f(void 0,null,function*(){if(i(d),!d||!d.dataTransfer||!d.dataTransfer.files||d.dataTransfer.files.length<0)return;let l=d.dataTransfer.files[0];yield c(l)}),c=d=>f(void 0,null,function*(){t==null||t.upload({file:d,$uploader:s,$uploadPanel:e})}),m=d=>f(void 0,null,function*(){let l=d.target;if(!l.files||l.files.length<=0)return;let y=l.files[0];yield c(y)});return t=u(n),t.init(),o==null||o.addEventListener("change",m),e==null||e.addEventListener("drag",r),e==null||e.addEventListener("dragstart",r),e==null||e.addEventListener("dragend",i),e==null||e.addEventListener("dragleave",i),e==null||e.addEventListener("dragover",a),e==null||e.addEventListener("dragenter",a),e==null||e.addEventListener("drop",g),{destroy:()=>{o==null||o.removeEventListener("change",m),e==null||e.removeEventListener("drag",r),e==null||e.removeEventListener("dragstart",r),e==null||e.removeEventListener("dragend",i),e==null||e.removeEventListener("dragleave",i),e==null||e.removeEventListener("dragover",a),e==null||e.removeEventListener("dragenter",a),e==null||e.removeEventListener("drop",g),t==null||t.destroy()}}},v=D;var T=s=>new Promise((n,t)=>{let e=new Image;e.crossOrigin="Anonymous",e.onerror=r=>t(r),e.onload=r=>{let{width:i,height:a}=r.target;n({$image:e,width:i,height:a})};let o=new FileReader;o.onerror=r=>t(r),o.onload=()=>{e.src=o.result},o.readAsDataURL(s)}),S=()=>{let s,n,t,e,o=()=>{var r;!s||((r=s.$uploadPanel)==null||r.classList.remove("hidden"),t==null||t.classList.add("hidden"),n==null||n.$image.remove(),n=void 0)};return{extensions:["jpg","jpeg","png","gif"],upload:r=>f(void 0,null,function*(){var a;if(s=r,t=s.$uploader.querySelector('[data-tc="preview-panel"]'),!t)return;(a=s.$uploadPanel)==null||a.classList.add("hidden"),t==null||t.classList.remove("hidden"),n=yield T(s.file);let i=t.querySelector('[data-tc="preview"]');i==null||i.append(n.$image),e=t.querySelector('[data-tc="cancel-preview"]'),e==null||e.addEventListener("click",o)}),destroy:()=>{var r;try{(r=n==null?void 0:n.$image)==null||r.remove()}catch(i){}e==null||e.removeEventListener("click",o),s=void 0,n=void 0,t=void 0,e=void 0}}},I=S;var L={path:"",plugins:[I]};var E=s=>{let n,t,e=r=>{let i=Object.assign(L,r);if(t=document.querySelector(i.path),!t){console.error("File uploader error: the path property is not defined.");return}n=v(t,i)},o=()=>{n==null||n.destroy(),n=void 0,t=void 0};return e(s),{destroy:o}},N=E;window.tcFileUploader=E;})();
//# sourceMappingURL=toolcool-file-uploader.min.js.map
