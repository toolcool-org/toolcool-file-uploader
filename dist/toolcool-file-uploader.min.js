/* 
Tool Cool File Uploader
Version: 0.0.1
Documentation: https://github.com/toolcool-org/toolcool-file-uploader
License:    
Author: Tool Cool, toolcool.org@gmail.com>                          
*/
(()=>{var f=(s,r,t)=>new Promise((e,i)=>{var n=a=>{try{c(t.next(a))}catch(l){i(l)}},o=a=>{try{c(t.throw(a))}catch(l){i(l)}},c=a=>a.done?e(a.value):Promise.resolve(a.value).then(n,o);c((t=t.apply(s,r)).next())});var D=s=>{let r=[];return{init:()=>{if(!!s.plugins)for(let n of s.plugins){let o=n(s);r.push(o),o.init&&typeof o.init=="function"&&o.init()}},upload:n=>{for(let o of r)o.upload&&typeof o.upload=="function"&&o.upload(n)},destroy:()=>{for(let n of r)n.destroy&&typeof n.destroy=="function"&&n.destroy()}}},v=D;var I="is-dragover",S=(s,r)=>{let t=null,e=s.querySelector('[data-tc="upload-panel"]'),i=e==null?void 0:e.querySelector('input[type="file"]'),n=d=>{d.preventDefault(),d.stopPropagation()},o=d=>{d.preventDefault(),d.stopPropagation(),e==null||e.classList.remove(I)},c=d=>{d.preventDefault(),d.stopPropagation(),e==null||e.classList.add(I)},a=d=>f(void 0,null,function*(){if(o(d),!d||!d.dataTransfer||!d.dataTransfer.files||d.dataTransfer.files.length<0)return;let m=d.dataTransfer.files[0];yield l(m)}),l=d=>f(void 0,null,function*(){t==null||t.upload({file:d,$uploader:s,$uploadPanel:e})}),g=d=>f(void 0,null,function*(){let m=d.target;if(!m.files||m.files.length<=0)return;let x=m.files[0];yield l(x)});return t=v(r),t.init(),i==null||i.addEventListener("change",g),e==null||e.addEventListener("drag",n),e==null||e.addEventListener("dragstart",n),e==null||e.addEventListener("dragend",o),e==null||e.addEventListener("dragleave",o),e==null||e.addEventListener("dragover",c),e==null||e.addEventListener("dragenter",c),e==null||e.addEventListener("drop",a),{destroy:()=>{i==null||i.removeEventListener("change",g),e==null||e.removeEventListener("drag",n),e==null||e.removeEventListener("dragstart",n),e==null||e.removeEventListener("dragend",o),e==null||e.removeEventListener("dragleave",o),e==null||e.removeEventListener("dragover",c),e==null||e.removeEventListener("dragenter",c),e==null||e.removeEventListener("drop",a),t==null||t.destroy()}}},L=S;var u=s=>s.slice((Math.max(0,s.lastIndexOf("."))||1/0)+1);var T=s=>new Promise((r,t)=>{let e=new Image;e.crossOrigin="Anonymous",e.onerror=n=>t(n),e.onload=n=>{let{width:o,height:c}=n.target;r({$image:e,width:o,height:c})};let i=new FileReader;i.onerror=n=>t(n),i.onload=()=>{e.src=i.result},i.readAsDataURL(s)}),C=s=>{let r,t,e,i,n,o=()=>{var a;!r||((a=r.$uploadPanel)==null||a.classList.remove("hidden"),e==null||e.classList.add("hidden"),t==null||t.$image.remove(),t=void 0)},c=()=>{var a,l;!r||s.uploadCallback&&typeof s.uploadCallback=="function"&&s.uploadCallback({file:r.file,ext:u((l=(a=r.file)==null?void 0:a.name)!=null?l:"")})};return{extensions:["jpg","jpeg","png","gif"],upload:a=>f(void 0,null,function*(){var g,p,d;if(r=a,e=r.$uploader.querySelector('[data-tc="preview-panel"]'),!e)return;(g=r.$uploadPanel)==null||g.classList.add("hidden"),e==null||e.classList.remove("hidden"),t=yield T(r.file);let l=e.querySelector('[data-tc="preview"]');l==null||l.append(t.$image),s.previewCallback&&typeof s.previewCallback=="function"&&s.previewCallback({file:a.file,ext:u((d=(p=a.file)==null?void 0:p.name)!=null?d:"")}),i=e.querySelector('[data-tc="cancel-preview-btn"]'),i==null||i.addEventListener("click",o),n=e.querySelector('[data-tc="upload-btn"]'),n==null||n.addEventListener("click",c)}),destroy:()=>{var a;try{(a=t==null?void 0:t.$image)==null||a.remove()}catch(l){}i==null||i.removeEventListener("click",o),n==null||n.removeEventListener("click",c),r=void 0,t=void 0,e=void 0,i=void 0,n=void 0}}},E=C;var y={path:"",plugins:[E]};var h=s=>{let r,t,e=n=>{let o=Object.assign(y,n);if(t=document.querySelector(o.path),!t){console.error("File uploader error: the path property is not defined.");return}r=L(t,o)},i=()=>{r==null||r.destroy(),r=void 0,t=void 0};return e(s),{destroy:i}},Y=h;window.tcFileUploader=h;})();
//# sourceMappingURL=toolcool-file-uploader.min.js.map
