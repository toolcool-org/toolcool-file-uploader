/* 
Tool Cool File Uploader - Image Preview Plugin
Version: 0.0.1
Documentation: https://github.com/toolcool-org/toolcool-file-uploader
License:    
Author: Tool Cool, toolcool.org@gmail.com>                          
*/
(()=>{var u=(d,n,a)=>new Promise((i,t)=>{var r=e=>{try{o(a.next(e))}catch(l){t(l)}},m=e=>{try{o(a.throw(e))}catch(l){t(l)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,m);o((a=a.apply(d,n)).next())});var f=d=>!isNaN(parseFloat(d))&&isFinite(d);var c=d=>new Promise((n,a)=>{let i=new Image;i.crossOrigin="Anonymous",i.onerror=r=>a(r),i.onload=r=>{let{width:m,height:o}=r.target;n({$image:i,width:m,height:o})};let t=new FileReader;t.onerror=r=>a(r),t.onload=()=>{i.src=t.result},t.readAsDataURL(d)}),g=d=>{let n,a,i,t,r,m=()=>{var e;!n||((e=n.$uploadPanel)==null||e.classList.remove("hidden"),i==null||i.classList.add("hidden"),a==null||a.$image.remove(),a=void 0,n.$fileInput&&(n.$fileInput.value=""))},o=()=>{!n||d.uploadCallback&&typeof d.uploadCallback=="function"&&d.uploadCallback({files:n.files})};return{id:"ImagePreviewPlugin",title:"Image Preview Plugin",extensions:["jpg","jpeg","png","apng","gif","avif","svg","webp"],mimeTypes:["image/jpeg","image/png","image/apng","image/avif","image/svg+xml","image/webp"],validate:(e,l)=>u(void 0,null,function*(){try{a=yield c(l)}catch(s){return{isValid:!1,message:"Invalid image."}}return f(e.maxWidth)&&a.width>e.maxWidth?{isValid:!1,message:`The image width should not be more than ${e.maxWidth} pixels.`}:f(e.maxHeight)&&a.height>e.maxHeight?{isValid:!1,message:`The image height should not be more than ${e.maxHeight} pixels.`}:{isValid:!0,message:""}}),upload:e=>u(void 0,null,function*(){var s;if(n=e,i=n.$uploader.querySelector('[data-tc="preview-panel"]'),!i||((s=n.$uploadPanel)==null||s.classList.add("hidden"),i==null||i.classList.remove("hidden"),t=i.querySelector('[data-tc="cancel-preview-btn"]'),t==null||t.addEventListener("click",m),r=i.querySelector('[data-tc="upload-btn"]'),r==null||r.addEventListener("click",o),n.files.length<=0))return;try{a=yield c(n.files[0])}catch(p){console.error("Image is not valid:",p)}if(!a)return;let l=i.querySelector('[data-tc="preview"]');l==null||l.append(a.$image),d.previewCallback&&typeof d.previewCallback=="function"&&d.previewCallback({files:e.files})}),destroy:()=>{var e;try{(e=a==null?void 0:a.$image)==null||e.remove()}catch(l){}t==null||t.removeEventListener("click",m),r==null||r.removeEventListener("click",o),n=void 0,a=void 0,i=void 0,t=void 0,r=void 0}}};window.tcfuImagePreviewPlugin=g;var x=g;})();
//# sourceMappingURL=tcfu-image-preview.min.js.map
