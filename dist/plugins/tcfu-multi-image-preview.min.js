/* 
Tool Cool File Uploader - Multi Image Preview Plugin
Version: 0.0.1
Documentation: https://github.com/toolcool-org/toolcool-file-uploader
License:    
Author: Tool Cool, toolcool.org@gmail.com>                          
*/
(()=>{var g=(l,t,r)=>new Promise((a,i)=>{var n=e=>{try{o(r.next(e))}catch(d){i(d)}},u=e=>{try{o(r.throw(e))}catch(d){i(d)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,u);o((r=r.apply(l,t)).next())});var c=l=>!isNaN(parseFloat(l))&&isFinite(l);var h=l=>new Promise((t,r)=>{let a=new Image;a.crossOrigin="Anonymous",a.onerror=n=>r(n),a.onload=n=>{let{width:u,height:o}=n.target;t({$image:a,width:u,height:o})};let i=new FileReader;i.onerror=n=>r(n),i.onload=()=>{a.src=i.result},i.readAsDataURL(l)}),I=l=>{let t,r=[],a,i,n,u=()=>{var e;if(!!t){(e=t.$uploadPanel)==null||e.classList.remove("hidden"),a==null||a.classList.add("hidden");for(let d of r)d.remove();r=[],t.$fileInput&&(t.$fileInput.value="")}},o=()=>{!t||l.uploadCallback&&typeof l.uploadCallback=="function"&&l.uploadCallback({files:t.files})};return{id:"MultiImagePreviewPlugin",title:"Multi Image Preview Plugin",extensions:["jpg","jpeg","png","apng","gif","avif","svg","webp"],mimeTypes:["image/jpeg","image/png","image/apng","image/avif","image/svg+xml","image/webp"],validate:(e,d)=>g(void 0,null,function*(){let m=null;try{m=yield h(d)}catch(p){}return m?c(e.maxWidth)&&m.width>e.maxWidth?{isValid:!1,message:`The image width should not be more than ${e.maxWidth} pixels.`}:c(e.maxHeight)&&m.height>e.maxHeight?{isValid:!1,message:`The image height should not be more than ${e.maxHeight} pixels.`}:{isValid:!0,message:""}:{isValid:!1,message:"Invalid image."}}),upload:e=>g(void 0,null,function*(){var m;if(t=e,a=t.$uploader.querySelector('[data-tc="preview-panel"]'),!a)return;(m=t.$uploadPanel)==null||m.classList.add("hidden"),a==null||a.classList.remove("hidden"),i=a.querySelector('[data-tc="cancel-preview-btn"]'),i==null||i.addEventListener("click",u),n=a.querySelector('[data-tc="upload-btn"]'),n==null||n.addEventListener("click",o);let d=a.querySelector('[data-tc="preview"]');for(let p of t.files){let s=null;try{s=yield h(p)}catch(v){console.error("Image is not valid:",v)}if(!s)continue;let f=document.createElement("figure");f.append(s.$image),r.push(f),d==null||d.append(f)}l.previewCallback&&typeof l.previewCallback=="function"&&l.previewCallback({files:e.files})}),destroy:()=>{for(let e of r)e.remove();r=[],i==null||i.removeEventListener("click",u),n==null||n.removeEventListener("click",o),t=void 0,a=void 0,i=void 0,n=void 0}}};window.tcfuImagePreviewPlugin=I;var y=I;})();
//# sourceMappingURL=tcfu-multi-image-preview.min.js.map
