/* 
Tool Cool File Uploader - Multi Image Preview Plugin
Version: 0.0.1
Documentation: https://github.com/toolcool-org/toolcool-file-uploader
License:    
Author: Tool Cool, toolcool.org@gmail.com>                          
*/
(()=>{var I=(l,r,i)=>new Promise((t,n)=>{var a=d=>{try{m(i.next(d))}catch(e){n(e)}},u=d=>{try{m(i.throw(d))}catch(e){n(e)}},m=d=>d.done?t(d.value):Promise.resolve(d.value).then(a,u);m((i=i.apply(l,r)).next())});var h=l=>!isNaN(parseFloat(l))&&isFinite(l);var v=l=>new Promise((r,i)=>{let t=new Image;t.crossOrigin="Anonymous",t.onerror=a=>i(a),t.onload=a=>{let{width:u,height:m}=a.target;r({$image:t,width:u,height:m})};let n=new FileReader;n.onerror=a=>i(a),n.onload=()=>{t.src=n.result},n.readAsDataURL(l)}),b=`<svg 
  xmlns="http://www.w3.org/2000/svg" 
  width="20"
  height="20"
  fill="none" 
  stroke="currentColor" 
  stroke-linecap="round" 
  stroke-linejoin="round" 
  stroke-width="1.5" 
  viewBox="0 0 24 24">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M18 6 6 18M6 6l12 12"/>
</svg>`,w=l=>{let r,i=[],t,n,a,u=()=>{var e;if(!!r){(e=r.$uploadPanel)==null||e.classList.remove("hidden"),t==null||t.classList.add("hidden");for(let s of i)s.$figure.remove();i=[],r.$fileInput&&(r.$fileInput.value="")}},m=()=>{!r||l.uploadCallback&&typeof l.uploadCallback=="function"&&l.uploadCallback({files:i.map(e=>e.file)})},d=e=>{let o=e.currentTarget.parentElement;if(!o)return;let c=i.findIndex(g=>g.$figure===o);c!==-1&&(i.splice(c,1),o.remove(),i.length<=0&&u())};return{id:"MultiImagePreviewPlugin",title:"Multi Image Preview Plugin",extensions:["jpg","jpeg","png","apng","gif","avif","svg","webp"],mimeTypes:["image/jpeg","image/png","image/apng","image/avif","image/svg+xml","image/webp"],validate:(e,s)=>I(void 0,null,function*(){let o=null;try{o=yield v(s)}catch(c){}return o?h(e.maxWidth)&&o.width>e.maxWidth?{isValid:!1,message:`The image width should not be more than ${e.maxWidth} pixels.`}:h(e.maxHeight)&&o.height>e.maxHeight?{isValid:!1,message:`The image height should not be more than ${e.maxHeight} pixels.`}:{isValid:!0,message:""}:{isValid:!1,message:"Invalid image."}}),upload:e=>I(void 0,null,function*(){var o;if(r=e,t=r.$uploader.querySelector('[data-tc="preview-panel"]'),!t)return;(o=r.$uploadPanel)==null||o.classList.add("hidden"),t==null||t.classList.remove("hidden"),n=t.querySelector('[data-tc="cancel-preview-btn"]'),n==null||n.addEventListener("click",u),a=t.querySelector('[data-tc="upload-btn"]'),a==null||a.addEventListener("click",m);let s=t.querySelector('[data-tc="preview"]');for(let c of r.files){let g=null;try{g=yield v(c)}catch(L){console.error("Image is not valid:",L)}if(!g)continue;let p=document.createElement("figure"),f=document.createElement("button");f.type="button",f.classList.add("tcfu-remove-btn"),f.innerHTML=b,p.append(f),f.addEventListener("click",d),p.append(g.$image),i.push({$figure:p,file:c}),s==null||s.append(p)}l.previewCallback&&typeof l.previewCallback=="function"&&l.previewCallback({files:e.files})}),destroy:()=>{for(let e of i)e.$figure.remove();i=[],n==null||n.removeEventListener("click",u),a==null||a.removeEventListener("click",m),r=void 0,t=void 0,n=void 0,a=void 0}}};window.tcfuMultiImagePreviewPlugin=w;var y=w;})();
//# sourceMappingURL=tcfu-multi-image-preview.min.js.map
